<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlueMoonJourneys - Book Your Trip</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="booking.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
     <style>
        :root {
            --mpesa-green: #2fb842;
            --slate-900: #0f172a;
            --slate-600: #475569;
            --slate-100: #f1f5f9;
            --white: #ffffff;
            --shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        body { font-family: 'Inter', system-ui, -apple-system, sans-serif; background: #e2e8f0; margin: 0; }

        /* Modal Overlay */
        .modal {
            position: fixed;
            inset: 0;
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(8px);
            display: flex; /* Toggle via JS */
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        /* Container */
        .modal-content {
            background: var(--white);
            width: 90%;
            max-width: 400px;
            border-radius: 28px;
            position: relative;
            box-shadow: var(--shadow);
            overflow: hidden;
            animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Header */
        .mpesa-header {
            padding: 40px 24px 10px;
            text-align: center;
        }

        .mpesa-logo { height: 30px; margin-bottom: 8px; }
        
        .mpesa-header h2 { 
            font-size: 1.1rem; 
            color: var(--slate-900); 
            margin: 0;
            font-weight: 700;
        }

        .close-btn {
            position: absolute;
            right: 20px;
            top: 20px;
            background: var(--slate-100);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--slate-600);
            border: none;
            font-size: 20px;
            z-index: 10;
        }

        /* Summary Card */
        .summary-card {
            background: var(--slate-100);
            margin: 20px 24px;
            padding: 20px;
            border-radius: 20px;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .summary-item.full { grid-column: span 2; }

        .summary-item label { 
            display: block;
            font-size: 11px; 
            text-transform: uppercase;
            letter-spacing: 0.02em;
            color: var(--slate-600); 
            margin-bottom: 2px;
        }
        
        .summary-item span { 
            font-size: 14px; 
            font-weight: 600; 
            color: var(--slate-900); 
        }

        .total-row {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .total-amount { 
            font-size: 22px; 
            font-weight: 800; 
            color: var(--mpesa-green); 
            letter-spacing: -0.5px;
        }

        /* Form Area */
        .form-area { padding: 0 24px 32px; }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--slate-900);
        }

        .input-wrapper { position: relative; margin-bottom: 24px; }

        .input-wrapper input {
            width: 100%;
            box-sizing: border-box;
            padding: 16px 16px 16px 45px;
            border: 2px solid var(--slate-100);
            border-radius: 14px;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.2s;
            outline: none;
        }

        .input-wrapper input:focus {
            border-color: var(--mpesa-green);
            background: white;
            box-shadow: 0 0 0 4px rgba(47, 184, 66, 0.1);
        }

        .input-wrapper i {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--slate-600);
        }

        /* Action Button */
        .mpesa-btn {
            width: 100%;
            background: var(--slate-900);
            color: white;
            border: none;
            padding: 18px;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }

        .mpesa-btn:hover { background: #000; }
        .mpesa-btn:active { transform: scale(0.98); }

        .security-badge {
            text-align: center;
            margin-top: 20px;
            font-size: 12px;
            color: var(--slate-600);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        /* Loader Overlay Fixes */
        .payment-loader-overlay {
            position: absolute;
            inset: 0;
            background: rgba(255, 255, 255, 0.95);
            z-index: 20;
            display: none; /* Controlled by JS */
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
   

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--slate-100);
            border-top: 3px solid var(--mpesa-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>


<body>
    <header>
    <div class="container">
        <img src="logo.png" alt="BlueMoonJourneys Logo" class="logo-img">
        
        <div class="hamburger-menu" id="hamburger-menu">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
        </div>
        <nav class="navbar" id="navbar">
            <a href="index.html#hero-section" class="nav-link">Home</a>
            <a href="#international-destinations" class="nav-link active">International Destinations</a>
            <a href="#local-kenya-travel" class="nav-link">Local Kenya Travel</a>
            <a href="index.html#about-us-section" class="nav-link">About Us</a>
            <a href="index.html#contact-section" class="nav-link">Contact</a>
        </nav>
    </div>
</header>
    <main>
        <section class="hero-search-section">
            <div class="hero-overlay"></div>
            <div class="hero-content container">
                <h1>Find Your Next Adventure</h1>
                <p>Explore breathtaking destinations and book your dream trip with ease.</p>
                <button class="btn btn-primary" id="book-now-btn" onclick="showBookingForm() ">Book Now</button>
            </div>
        </section>

        <section id="international-destinations" class="trip-listings">
            <div class="container">
                <h2>International Destinations</h2>
                <div class="filter-sort-controls">
                    <div class="filters">
                        <h3>Filter by:</h3>
                        <div class="filter-group">
                            <h4>Trip Type</h4>
                            <label><input type="checkbox" class="filter-type" value="Adventure"> Adventure</label>
                            <label><input type="checkbox" class="filter-type" value="Cultural"> Cultural</label>
                            <label><input type="checkbox" class="filter-type" value="Relaxation"> Relaxation</label>
                            <label><input type="checkbox" class="filter-type" value="Family"> Family</label>
                            <label><input type="checkbox" class="filter-type" value="Solo"> Solo</label>
                            <label><input type="checkbox" class="filter-type" value="Luxury"> Luxury</label>
                            <label><input type="checkbox" class="filter-type" value="Wildlife"> Wildlife</label>
                        </div>
                        <div class="filter-group">
                            <h4>Price Range</h4>
                            <input type="range" id="price-range" min="0" max="5000" value="5000">
                            <span id="price-range-value">Up to $5000</span>
                        </div>
                        <div class="filter-group">
                            <h4>Duration (Days)</h4>
                            <input type="number" id="duration-min" placeholder="Min" min="1"> -
                            <input type="number" id="duration-max" placeholder="Max" min="1">
                        </div>
                    </div>
                    <div class="sorting">
                        <h3>Sort by:</h3>
                        <select id="sort-by">
                            <option value="popularity">Popularity</option>
                            <option value="price-asc">Price (Low to High)</option>
                            <option value="price-desc">Price (High to Low)</option>
                        </select>
                    </div>
                </div>

                <div class="trip-grid" id="international-trip-grid">
                    <p id="no-international-results" style="display: none;">No international trips found matching your criteria. Please adjust your search.</p>
                </div>
            </div>
        </section>

        ---

        <section id="local-kenya-travel" class="trip-listings">
            <div class="container">
                <h2>Explore Kenya - Local Adventures</h2>
                <div class="filter-sort-controls">
                    <div class="filters">
                        <h3>Filter by:</h3>
                        <div class="filter-group">
                            <h4>Kenya Trip Type</h4>
                            <label><input type="checkbox" class="local-filter-type" value="Safari"> Safari</label>
                            <label><input type="checkbox" class="local-filter-type" value="Beach"> Beach</label>
                            <label><input type="checkbox" class="local-filter-type" value="Mountain"> Mountain</label>
                            <label><input type="checkbox" class="local-filter-type" value="City Escape"> City Escape</label>
                        </div>
                        <div class="filter-group">
                            <h4>Price Range (KES)</h4>
                            <input type="range" id="local-price-range" min="0" max="150000" value="150000">
                            <span id="local-price-range-value">Up to KES 150,000</span>
                        </div>
                        <div class="filter-group">
                            <h4>Duration (Days)</h4>
                            <input type="number" id="local-duration-min" placeholder="Min" min="1"> -
                            <input type="number" id="local-duration-max" placeholder="Max" min="1">
                        </div>
                    </div>
                    <div class="sorting">
                        <h3>Sort by:</h3>
                        <select id="local-sort-by">
                            <option value="popularity">Popularity</option>
                            <option value="price-asc">Price (Low to High)</option>
                            <option value="price-desc">Price (High to Low)</option>
                        </select>
                    </div>
                </div>

                <div class="trip-grid" id="local-trip-grid">
                    <p id="no-local-results" style="display: none;">No local trips found matching your criteria. Please adjust your search.</p>
                </div>
            </div>
        </section>


        ---
        <section id="about-us-section" class="cta-newsletter">
            <div class="container">
                <h2>Don't Miss Out on Amazing Deals!</h2>
                <p>Sign up for our newsletter to get exclusive offers and travel inspiration directly to your inbox.</p>
                <form class="newsletter-form">
                    <input type="email" placeholder="Your Email Address" required>
                    <button type="submit" class="btn btn-secondary">Subscribe Now</button>
                </form>
            </div>
        </section>

        <section id="contact-section" style="padding: 80px 0; background-color: var(--white);">
            <div class="container">
                <h2>Contact Us</h2>
                <p>Have questions or need assistance? Reach out to us!</p>
                <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 30px; margin-top: 40px;">
                    <div style="flex: 1; min-width: 280px; max-width: 400px; padding: 25px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); text-align: left; background-color: var(--bg-light-grey);">
                        <h3>Our Office</h3>
                        <p><i class="fas fa-map-marker-alt" style="margin-right: 10px; color: var(--secondary-light-blue);"></i>Eldoret, Kenya</p>
                        <p><i class="fas fa-phone" style="margin-right: 10px; color: var(--secondary-light-blue);"></i>+254 703 161 031</p>
                        <p><i class="fas fa-envelope" style="margin-right: 10px; color: var(--secondary-light-blue);"></i>info@bluemoonjourneys.com</p>
                    </div>
                    <div style="flex: 1; min-width: 280px; max-width: 400px; padding: 25px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); text-align: left; background-color: var(--bg-light-grey);">
                        <h3>Send Us a Message</h3>
                        <form style="display: flex; flex-direction: column; gap: 15px;">
                            <input type="text" placeholder="Your Name" style="padding: 12px; border: 1px solid var(--border-light); border-radius: 6px;">
                            <input type="email" placeholder="Your Email" style="padding: 12px; border: 1px solid var(--border-light); border-radius: 6px;">
                            <textarea placeholder="Your Message" rows="5" style="padding: 12px; border: 1px solid var(--border-light); border-radius: 6px; resize: vertical;"></textarea>
                            <button type="submit" class="btn btn-primary" style="align-self: flex-start;">Send Message</button>
                        </form>
                    </div>
                </div>
            </div>
        </section>
        <section class="booking-prompt">
            
            <div class="container" style="display: none;">
                <h2>Ready to Book Your Trip?</h2>
                <p>fill out the form below to start your booking process.</p>
                <form class="booking-form">
                    <div class="form-group">
                        <label for="name">Your Name</label>
                        <input type="text" id="name" placeholder="Enter your name" required>
                        <label for="email">Your Email</label>
                        <input type="email" id="email" placeholder="Enter your email" required>
                        <label for="phone">Your Phone Number</label>
                        <input type="tel" id="phone" placeholder="Enter your phone number" required>
                        <label for="trip-type">Trip Type</label>
                        <select id="trip-type" required>
                            <option value="" disabled selected>Select trip type</option>
                            <option value="adventure">Adventure</option>
                            <option value="cultural">Cultural</option>
                            <option value="relaxation">Relaxation</option>
                            <option value="family">Family</option>
                            <option value="solo">Solo</option>
                            <option value="luxury">Luxury</option>
                            <option value="wildlife">Wildlife</option>
                        </select>
                        <label for="destination">Preferred Destination</label>
                        <select id="destination" required>
                            <option value="" disabled selected>Select destination</option>
                            <option value="paris">Paris</option>
                            <option value="safari">Safari</option>
                            <option value="beach">Beach</option>
                            <option value="mountain">Mountain</option>
                            <option value="city-escape">City Escape</option>
                            <option value="safari">Safari</option>
                            <option value="beach">Beach</option>
                        </select>
                        <label class="amount" inputmode="selected"></label>
                        <label for="travel-dates">Preferred Travel Dates</label>    
                        <calendar id="travel-dates" placeholder="Select travel dates" required></calendar>
                        <label for="special-requests">Special Requests</label>
                        <textarea id="special-requests" placeholder="Any special requests?"></textarea>
                        <p>card information</p>
                        <label for="card-number">Card Number</label>
                        <input type="text" id="card-number" placeholder="Enter your card number" required>
                        <label for="expiry-date">Expiry Date</label>
                        <input type="text" id="expiry-date" placeholder="MM/YY" required>
                        <label for="cvv">CVV</label>
                        <input type="text" id="cvv" placeholder="Enter your CVV" required>
                        <button type="submit" class="btn btn-primary">Book Now</button>
                    </div>
                    </div>
                    
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2026 underworldtech | Bluemoonjourneys. All rights reserved.</p>
            <div class="social-links">
                <a href="#"><i class="fab fa-facebook-f"></i></a>
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
                <a href="#"><i class="fab fa-pinterest-p"></i></a>
            </div>
            <div class="footer-links">
                <a href="#">Privacy Policy</a>
                <a href="#">Terms of Service</a>
            </div>
        </div>
    </footer>

    <button id="scrollToTopBtn" title="Go to top"><i class="fas fa-arrow-up"></i></button>

    <!-- Trip Details Modal -->
    <div id="tripDetailsModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div class="modal-header">
                <img id="modalTripImage" src="" alt="Trip Image" class="modal-trip-image">
            </div>
            <div class="modal-body">
                <h2 id="modalTripTitle"></h2>
                <p id="modalTripDescription"></p>
                
                <div class="modal-details">
                    <div class="detail-section">
                        <h3>Trip Highlights</h3>
                        <ul id="modalTripHighlights"></ul>
                    </div>
                    
                    <div class="detail-section">
                        <h3>Trip Information</h3>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Duration:</span>
                                <span id="modalTripDuration" class="info-value"></span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Type:</span>
                                <span id="modalTripType" class="info-value"></span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Price:</span>
                                <span id="modalTripPrice" class="info-value"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-actions">
                    <button id="modalPayButton" class="btn btn-primary">Proceed to Payment</button>
                    <button class="btn btn-secondary close-modal-btn">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- M-Pesa Payment Modal -->
  <div id="mpesaPaymentModal" class="modal">
  <div class="modal-content">
    <button class="close-btn" onclick="mpesaPaymentHandler.closePaymentModal()" aria-label="Close modal">&times;</button>

    <div id="mpesaLoaderOverlay" class="payment-loader-overlay">
      <div class="loader-visual">
        <div class="spinner-outer"></div>
        <i class="fas fa-mobile-screen-button loader-icon"></i>
      </div>
      <h3 class="status-text pulse">Awaiting Payment...</h3>
      <p class="instruction-text">
        Please check your phone for the <strong>M-Pesa PIN prompt</strong> to complete your booking.
      </p>
      <div class="loader-footer">
        <i class="fas fa-circle-notch fa-spin"></i>
        <span id="pollingCountdown">Do not refresh or close this page</span>
      </div>
    </div>

    <div id="mpesaMainContent">
      <div class="mpesa-header">
        <img src="https://upload.wikimedia.org/wikipedia/commons/1/15/M-PESA_LOGO-01.svg" alt="M-Pesa" class="mpesa-logo">
        <h2>Secure Checkout</h2>
      </div>

      <div class="booking-summary">
        <div class="summary-card">
          <div class="summary-grid">
            <div class="summary-item full">
              <label>Destination</label>
              <span id="mpesaSummaryDestination">--</span>
            </div>
            <div class="summary-item">
              <label>Travelers</label>
              <span id="mpesaSummaryTravelers">--</span>
            </div>
            <div class="summary-item">
              <label>Dates</label>
              <span id="mpesaSummaryDate">--</span>
            </div>
          </div>
          <div class="total-row">
            <label>Total Amount</label>
            <span id="mpesaSummaryAmount" class="total-amount">KES 0.00</span>
          </div>
        </div>
      </div>

      <form id="mpesaPaymentForm" class="form-area">
        <div class="form-group">
          <label for="mpesaPhoneNumber">M-Pesa Phone Number</label>
          <div class="input-wrapper">
            <i class="fas fa-phone"></i>
            <input 
              type="tel" 
              id="mpesaPhoneNumber" 
              placeholder="+254712345678" 
              pattern="^(\+?254|0)[17]\d{8}$"
              required
            >
          </div>
          <p class="input-hint">
            Ensure your phone is unlocked to receive the STK push prompt.
          </p>
        </div>

        <button type="submit" id="mpesaSubmitButton" class="mpesa-btn">
          <i class="fas fa-lock"></i>
          <span>Pay <span id="btnAmount">KES 0.00</span></span>
        </button>
      </form>

      <div class="security-badge">
        <i class="fas fa-shield-halved"></i> 
        <span>Payments are securely processed via the Safaricom M-Pesa API. We do not store your PIN</span>
      </div>
    </div>
  </div>
</div>

    <!-- API and M-Pesa Integration -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="api.js"></script>
    <script src="mpesa.js"></script>
    
    <script src="booking.js"></script>
</body>
    
</html>
